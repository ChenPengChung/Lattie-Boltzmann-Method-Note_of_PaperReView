#ifndef MRT_Matrix_FILE
#define MRT_Matrix_FILE
//對角線矩陣 
#define Relaxation		\
	s0  = 0.0;			\
	s1  = 1.19;			\
	s2  = 1.4;			\
	s3  = 0.0;			\
	s4  = 1.2;			\
	s5  = 0.0;			\
	s6  = 1.2;			\
	s7  = 0.0;			\
	s8  = 1.2;	 		\
	s9  = (1.0/tau);	\
	s10 = 1.4;			\
	s11 = (1.0/tau);	\
	s12 = 1.4;			\
	s13 = (1.0/tau);	\
	s14 = (1.0/tau);	\
	s15 = (1.0/tau);	\
	s16 = 1.5;			\
	s17 = 1.5;			\
	s18 = 1.5;

////Matrix(Corrected)////
//Tim Kruger page 672. 
#define Matrix\
	double M[19][19]={{   1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1 } ,\
	                  { -30,-11,-11,-11,-11,-11,-11,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8 } ,\
		       	      {  12, -4, -4, -4, -4, -4, -4,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1 } ,\
	 	    	      {   0,  1, -1,  0,  0,  0,  0,  1, -1,  1, -1,  1, -1,  1, -1,  0,  0,  0,  0 } ,\
			          {   0, -4,  4,  0,  0,  0,  0,  1, -1,  1, -1,  1, -1,  1, -1,  0,  0,  0,  0 } ,\
			          {   0,  0,  0,  1, -1,  0,  0,  1,  1, -1, -1,  0,  0,  0,  0,  1, -1,  1, -1 } ,\
			          {   0,  0,  0, -4,  4,  0,  0,  1,  1, -1, -1,  0,  0,  0,  0,  1, -1,  1, -1 } ,\
			          {   0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  1,  1, -1, -1,  1,  1, -1, -1 } ,\
			          {   0,  0,  0,  0,  0, -4,  4,  0,  0,  0,  0,  1,  1, -1, -1,  1,  1, -1, -1 } ,\
			          {   0,  2,  2, -1, -1, -1, -1,  1,  1,  1,  1,  1,  1,  1,  1, -2, -2, -2, -2 } ,\
			          {   0, -4, -4,  2,  2,  2,  2,  1,  1,  1,  1,  1,  1,  1,  1, -2, -2, -2, -2 } ,\
			          {   0,  0,  0,  1,  1, -1, -1,  1,  1,  1,  1, -1, -1, -1, -1,  0,  0,  0,  0 } ,\
			          {   0,  0,  0, -2, -2,  2,  2,  1,  1,  1,  1, -1, -1, -1, -1,  0,  0,  0,  0 } ,\
			          {   0,  0,  0,  0,  0,  0,  0,  1, -1, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0 } ,\
			          {   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -1, -1,  1 } ,\
			          {   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -1, -1,  1,  0,  0,  0,  0 } ,\
			          {   0,  0,  0,  0,  0,  0,  0,  1, -1,  1, -1, -1,  1, -1,  1,  0,  0,  0,  0 } ,\
			          {   0,  0,  0,  0,  0,  0,  0, -1, -1,  1,  1,  0,  0,  0,  0,  1, -1,  1, -1 } ,\
			          {   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1, -1, -1, -1, -1,  1,  1 }};

////Inverse Matrix(Completed)////     
#define Inverse_Matrix	//M matrix * S = relaxartion rate Matrix 
	double Mi[19][19]={{1.0/19.0  ,   -5.0/399.0  ,   1.0/21.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0   ,       0.0  },\
	                   {1.0/19.0  , -11.0/2394.0  ,  -1.0/63.0  ,  1.0/10.0  , -1.0/10.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,  1.0/18.0  , -1.0/18.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,        0.0  },\
		       	       {1.0/19.0  , -11.0/2394.0  ,  -1.0/63.0  , -1.0/10.0  ,  1.0/10.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,  1.0/18.0  , -1.0/18.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,        0.0  },\
	 	    	       {1.0/19.0  , -11.0/2394.0  ,  -1.0/63.0  ,       0.0  ,       0.0  ,  1.0/10.0  , -1.0/10.0  ,       0.0  ,       0.0  , -1.0/36.0  ,  1.0/36.0  ,  1.0/12.0  , -1.0/12.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,        0.0  },\
			           {1.0/19.0  , -11.0/2394.0  ,  -1.0/63.0  ,       0.0  ,       0.0  , -1.0/10.0  ,  1.0/10.0  ,       0.0  ,       0.0  , -1.0/36.0  ,  1.0/36.0  ,  1.0/12.0  , -1.0/12.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,        0.0  },\
			           {1.0/19.0  , -11.0/2394.0  ,  -1.0/63.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,  1.0/10.0  , -1.0/10.0  , -1.0/36.0  ,  1.0/36.0  , -1.0/12.0  ,  1.0/12.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,        0.0  },\
			           {1.0/19.0  , -11.0/2394.0  ,  -1.0/63.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  , -1.0/10.0  ,  1.0/10.0  , -1.0/36.0  ,  1.0/36.0  , -1.0/12.0  ,  1.0/12.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,       0.0  ,        0.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  ,  1.0/10.0  ,  1.0/40.0  ,  1.0/10.0  ,  1.0/40.0  ,       0.0  ,       0.0  ,  1.0/36.0  ,  1.0/72.0  ,  1.0/12.0  ,  1.0/24.0  ,   1.0/4.0  ,       0.0  ,       0.0  ,   1.0/8.0  ,  -1.0/8.0  ,        0.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  , -1.0/10.0  , -1.0/40.0  ,  1.0/10.0  ,  1.0/40.0  ,       0.0  ,       0.0  ,  1.0/36.0  ,  1.0/72.0  ,  1.0/12.0  ,  1.0/24.0  ,  -1.0/4.0  ,       0.0  ,       0.0  ,  -1.0/8.0  ,  -1.0/8.0  ,        0.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  ,  1.0/10.0  ,  1.0/40.0  , -1.0/10.0  , -1.0/40.0  ,       0.0  ,       0.0  ,  1.0/36.0  ,  1.0/72.0  ,  1.0/12.0  ,  1.0/24.0  ,  -1.0/4.0  ,       0.0  ,       0.0  ,   1.0/8.0  ,   1.0/8.0  ,        0.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  , -1.0/10.0  , -1.0/40.0  , -1.0/10.0  , -1.0/40.0  ,       0.0  ,       0.0  ,  1.0/36.0  ,  1.0/72.0  ,  1.0/12.0  ,  1.0/24.0  ,   1.0/4.0  ,       0.0  ,       0.0  ,  -1.0/8.0  ,   1.0/8.0  ,        0.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  ,  1.0/10.0  ,  1.0/40.0  ,       0.0  ,       0.0  ,  1.0/10.0  ,  1.0/40.0  ,  1.0/36.0  ,  1.0/72.0  , -1.0/12.0  , -1.0/24.0  ,       0.0  ,       0.0  ,   1.0/4.0  ,  -1.0/8.0  ,       0.0  ,    1.0/8.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  , -1.0/10.0  , -1.0/40.0  ,       0.0  ,       0.0  ,  1.0/10.0  ,  1.0/40.0  ,  1.0/36.0  ,  1.0/72.0  , -1.0/12.0  , -1.0/24.0  ,       0.0  ,       0.0  ,  -1.0/4.0  ,   1.0/8.0  ,       0.0  ,    1.0/8.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  ,  1.0/10.0  ,  1.0/40.0  ,       0.0  ,       0.0  , -1.0/10.0  , -1.0/40.0  ,  1.0/36.0  ,  1.0/72.0  , -1.0/12.0  , -1.0/24.0  ,       0.0  ,       0.0  ,  -1.0/4.0  ,  -1.0/8.0  ,       0.0  ,   -1.0/8.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  , -1.0/10.0  , -1.0/40.0  ,       0.0  ,       0.0  , -1.0/10.0  , -1.0/40.0  ,  1.0/36.0  ,  1.0/72.0  , -1.0/12.0  , -1.0/24.0  ,       0.0  ,       0.0  ,   1.0/4.0  ,   1.0/8.0  ,       0.0  ,   -1.0/8.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  ,       0.0  ,       0.0  ,  1.0/10.0  ,  1.0/40.0  ,  1.0/10.0  ,  1.0/40.0  , -1.0/18.0  , -1.0/36.0  ,       0.0  ,       0.0  ,       0.0  ,   1.0/4.0  ,       0.0  ,       0.0  ,   1.0/8.0  ,   -1.0/8.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  ,       0.0  ,       0.0  , -1.0/10.0  , -1.0/40.0  ,  1.0/10.0  ,  1.0/40.0  , -1.0/18.0  , -1.0/36.0  ,       0.0  ,       0.0  ,       0.0  ,  -1.0/4.0  ,       0.0  ,       0.0  ,  -1.0/8.0  ,   -1.0/8.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  ,       0.0  ,       0.0  ,  1.0/10.0  ,  1.0/40.0  , -1.0/10.0  , -1.0/40.0  , -1.0/18.0  , -1.0/36.0  ,       0.0  ,       0.0  ,       0.0  ,  -1.0/4.0  ,       0.0  ,       0.0  ,   1.0/8.0  ,    1.0/8.0  },\
			           {1.0/19.0  ,   4.0/1197.0  ,  1.0/252.0  ,       0.0  ,       0.0  , -1.0/10.0  , -1.0/40.0  , -1.0/10.0  , -1.0/40.0  , -1.0/18.0  , -1.0/36.0  ,       0.0  ,       0.0  ,       0.0  ,   1.0/4.0  ,       0.0  ,       0.0  ,  -1.0/8.0  ,    1.0/8.0  }};



#endif

#define m_matrix	\
	m0 = F0_in*M[0][0] + F1_in*M[0][1] + F2_in*M[0][2] + F3_in*M[0][3] + F4_in*M[0][4] + F5_in*M[0][5] + F6_in*M[0][6] + F7_in*M[0][7] + F8_in*M[0][8] + F9_in*M[0][9] + 						\
         F10_in*M[0][10] + F11_in*M[0][11] + F12_in*M[0][12] + F13_in*M[0][13] + F14_in*M[0][14] + F15_in*M[0][15] + F16_in*M[0][16] + F17_in*M[0][17] + F18_in*M[0][18];						\
		 																																														\
//形成一組moment 
//M作為一組基底變換矩陣與分佈函數取內積物理意義為分佈函數的矩 
//gram-schmit  正交化做為尋找一組正交基底 方法，假設一組 非正交向量集，透過此法可以尋找出該向量集的向量空間的一組基底 